<!DOCTYPE html>
<html>
<head>
    <title>Admin Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-storage-compat.js"></script>
</head>
<body>
    <div class="container mt-5">
        <!-- Login Form -->
        <div id="login-section">
            <h2>Admin Login</h2>
            <input type="email" id="email" placeholder="Email" class="form-control mb-2">
            <input type="password" id="password" placeholder="Password" class="form-control mb-2">
            <button onclick="login()" class="btn btn-primary">Login</button>
        </div>

        <!-- Dashboard (Hidden Initially) -->
        <div id="dashboard-section" style="display:none;">
            <h2>Upload Questions</h2>
            <input type="file" id="file" class="form-control mb-2">
            <button onclick="upload()" class="btn btn-success">Upload</button>
            <button onclick="logout()" class="btn btn-danger">Logout</button>
        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCEvPQ-j6xMtuYDGBS_G6IRsBgZVs",
            authDomain: "questionpapadmin.firebaseapp.com",
            projectId: "questioperadmin",
            storageBucket: "questioperadmin.appspot.com",  // Fixed syntax
            appId: "315139864:web:50fea187a8f2e34c7298ad"
        };

        // Initialize after DOM loads
        document.addEventListener('DOMContentLoaded', function() {
            firebase.initializeApp(firebaseConfig);
            console.log("Firebase initialized!");
            
            // Auto-redirect if already logged in
            firebase.auth().onAuthStateChanged(user => {
                if (user) {
                    document.getElementById('login-section').style.display = 'none';
                    document.getElementById('dashboard-section').style.display = 'block';
                }
            });
        });

        function login() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            if (!email || !password) {
                alert("Please enter both email and password");
                return;
            }

            firebase.auth().signInWithEmailAndPassword(email, password)
                .then(() => {
                    console.log("Login successful!");
                })
                .catch(error => {
                    console.error("Login error:", error);
                    alert("Login failed: " + error.message);
                });
        }

        function logout() {
            firebase.auth().signOut()
                .then(() => {
                    document.getElementById('dashboard-section').style.display = 'none';
                    document.getElementById('login-section').style.display = 'block';
                });
        }

        function upload() {
            const file = document.getElementById('file').files[0];
            if (!file) return alert("No file selected");

            const storageRef = firebase.storage().ref('questions/' + file.name);
            storageRef.put(file)
                .then(() => alert("File uploaded!"))
                .catch(err => alert("Upload failed: " + err.message));
        }
    </script>
</body>
</html>